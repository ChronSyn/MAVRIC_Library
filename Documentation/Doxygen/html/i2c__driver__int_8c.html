<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>MAV&#39;RIC: /home/julien/Desktop/tmp/maveric/Code/Library/hal/i2c_driver_int.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAV&#39;RIC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6aa15536841142c7fd9884591ab4637c.html">Code</a></li><li class="navelem"><a class="el" href="dir_441424e0798b093b83594b97ee19973a.html">Library</a></li><li class="navelem"><a class="el" href="dir_b9860ec229d60a4e05a0bedc78cf89ab.html">hal</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">i2c_driver_int.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="i2c__driver__int_8h_source.html">i2c_driver_int.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gpio_8h_source.html">gpio.h</a>&quot;</code><br />
<code>#include &quot;sysclk.h&quot;</code><br />
<code>#include &quot;<a class="el" href="print__util_8h_source.html">print_util.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for i2c_driver_int.c:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__driver__int_8c__incl.png" border="0" usemap="#_2home_2julien_2Desktop_2tmp_2maveric_2Code_2Library_2hal_2i2c__driver__int_8c" alt=""/></div>
<map name="_2home_2julien_2Desktop_2tmp_2maveric_2Code_2Library_2hal_2i2c__driver__int_8c" id="_2home_2julien_2Desktop_2tmp_2maveric_2Code_2Library_2hal_2i2c__driver__int_8c">
<area shape="rect" id="node2" href="i2c__driver__int_8h.html" title="i2c_driver_int.h" alt="" coords="2157,109,2267,136"/><area shape="rect" id="node44" href="gpio_8h.html" title="GPIO software driver interface for AVR UC3. " alt="" coords="1731,184,1789,211"/><area shape="rect" id="node46" href="print__util_8h.html" title="print_util.h" alt="" coords="2423,109,2505,136"/><area shape="rect" id="node3" href="twim_8h.html" title="TWIM driver for AVR32 UC3. " alt="" coords="2035,184,2096,211"/><area shape="rect" id="node11" href="dma__channel__config_8h.html" title="dma_channel_config.h" alt="" coords="1859,184,2011,211"/><area shape="rect" id="node12" href="scheduler_8h.html" title="scheduler.h" alt="" coords="2259,184,2349,211"/><area shape="rect" id="node7" href="status__codes_8h.html" title="Status code definitions. " alt="" coords="2010,259,2121,285"/><area shape="rect" id="node8" href="conf__twim_8h.html" title="TWIM Configuration File for AVR32 UC3. " alt="" coords="1887,259,1980,285"/><area shape="rect" id="node9" href="board_8h.html" title="Standard board header file. " alt="" coords="1871,341,1937,367"/><area shape="rect" id="node10" href="conf__board_8h.html" title="User board configuration template. " alt="" coords="1862,423,1959,449"/><area shape="rect" id="node14" href="mavlink__stream_8h.html" title="mavlink_stream.h" alt="" coords="2351,259,2476,285"/><area shape="rect" id="node15" href="streams_8h.html" title="streams.h" alt="" coords="2585,341,2665,367"/><area shape="rect" id="node17" href="maveric_2mavlink_8h.html" title="MAVLink comm protocol built from maveric2.xml. " alt="" coords="1961,333,2124,375"/><area shape="rect" id="node18" href="maveric_2version_8h.html" title="MAVLink comm protocol built from maveric2.xml. " alt="" coords="1997,423,2072,449"/><area shape="rect" id="node19" href="maveric2_8h.html" title="MAVLink comm protocol generated from maveric2.xml. " alt="" coords="2097,423,2183,449"/><area shape="rect" id="node20" href="protocol_8h_source.html" title="../protocol.h" alt="" coords="5,505,96,531"/><area shape="rect" id="node21" href="maveric_2mavlink__msg__heartbeat_8h_source.html" title="./mavlink_msg_heartbeat.h" alt="" coords="120,505,299,531"/><area shape="rect" id="node22" href="maveric_2mavlink__msg__sys__status_8h_source.html" title="./mavlink_msg_sys_status.h" alt="" coords="323,505,512,531"/><area shape="rect" id="node23" href="maveric_2mavlink__msg__system__time_8h_source.html" title="./mavlink_msg_system\l_time.h" alt="" coords="536,497,693,539"/><area shape="rect" id="node24" href="maveric_2mavlink__msg__ping_8h_source.html" title="./mavlink_msg_ping.h" alt="" coords="717,505,867,531"/><area shape="rect" id="node25" href="maveric_2mavlink__msg__change__operator__control_8h_source.html" title="./mavlink_msg_change\l_operator_control.h" alt="" coords="891,497,1047,539"/><area shape="rect" id="node26" href="maveric_2mavlink__msg__change__operator__control__ack_8h_source.html" title="./mavlink_msg_change\l_operator_control_ack.h" alt="" coords="1071,497,1233,539"/><area shape="rect" id="node27" href="maveric_2mavlink__msg__auth__key_8h_source.html" title="./mavlink_msg_auth\l_key.h" alt="" coords="1257,497,1396,539"/><area shape="rect" id="node28" href="maveric_2mavlink__msg__set__mode_8h_source.html" title="./mavlink_msg_set_mode.h" alt="" coords="1421,505,1603,531"/><area shape="rect" id="node29" href="maveric_2mavlink__msg__param__request__read_8h_source.html" title="./mavlink_msg_param\l_request_read.h" alt="" coords="1627,497,1778,539"/><area shape="rect" id="node30" href="maveric_2mavlink__msg__param__request__list_8h_source.html" title="./mavlink_msg_param\l_request_list.h" alt="" coords="1802,497,1953,539"/><area shape="rect" id="node31" href="maveric_2mavlink__msg__param__value_8h_source.html" title="./mavlink_msg_param\l_value.h" alt="" coords="1977,497,2127,539"/><area shape="rect" id="node32" href="maveric_2mavlink__msg__param__set_8h_source.html" title="./mavlink_msg_param\l_set.h" alt="" coords="2151,497,2302,539"/><area shape="rect" id="node33" href="maveric_2mavlink__msg__gps__raw__int_8h_source.html" title="./mavlink_msg_gps_raw\l_int.h" alt="" coords="2327,497,2489,539"/><area shape="rect" id="node34" href="maveric_2mavlink__msg__gps__status_8h_source.html" title="./mavlink_msg_gps_status.h" alt="" coords="2513,505,2703,531"/><area shape="rect" id="node35" href="maveric_2mavlink__msg__scaled__imu_8h_source.html" title="./mavlink_msg_scaled\l_imu.h" alt="" coords="2727,497,2879,539"/><area shape="rect" id="node36" href="maveric_2mavlink__msg__raw__imu_8h_source.html" title="./mavlink_msg_raw_imu.h" alt="" coords="2903,505,3078,531"/><area shape="rect" id="node37" href="maveric_2mavlink__msg__raw__pressure_8h_source.html" title="./mavlink_msg_raw_pressure.h" alt="" coords="3103,505,3305,531"/><area shape="rect" id="node38" href="maveric_2mavlink__msg__scaled__pressure_8h_source.html" title="./mavlink_msg_scaled\l_pressure.h" alt="" coords="3329,497,3481,539"/><area shape="rect" id="node39" href="maveric_2mavlink__msg__attitude_8h_source.html" title="./mavlink_msg_attitude.h" alt="" coords="3505,505,3673,531"/><area shape="rect" id="node40" href="maveric_2mavlink__msg__attitude__quaternion_8h_source.html" title="./mavlink_msg_attitude\l_quaternion.h" alt="" coords="3697,497,3855,539"/><area shape="rect" id="node41" href="maveric_2mavlink__msg__local__position__ned_8h_source.html" title="./mavlink_msg_local\l_position_ned.h" alt="" coords="3879,497,4020,539"/><area shape="rect" id="node42" href="maveric_2mavlink__msg__global__position__int_8h_source.html" title="./mavlink_msg_global\l_position_int.h" alt="" coords="4043,497,4191,539"/><area shape="rect" id="node43" href="maveric_2mavlink__msg__rc__channels__scaled_8h_source.html" title="./mavlink_msg_rc_channels\l_scaled.h" alt="" coords="4216,497,4400,539"/><area shape="rect" id="node47" href="quaternions_8h.html" title="quaternions.h" alt="" coords="2683,184,2783,211"/><area shape="rect" id="node48" href="maths_8h.html" title="maths.h" alt="" coords="2791,341,2860,367"/><area shape="rect" id="node50" href="vectors_8h_source.html" title="vectors.h" alt="" coords="2741,259,2817,285"/></map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a93dd36de61c62b79966587eb2e1cf479"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#a93dd36de61c62b79966587eb2e1cf479">i2c_driver_reset</a> (uint8_t i2c_device)</td></tr>
<tr class="memdesc:a93dd36de61c62b79966587eb2e1cf479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the i2c driver.  <a href="#a93dd36de61c62b79966587eb2e1cf479">More...</a><br /></td></tr>
<tr class="separator:a93dd36de61c62b79966587eb2e1cf479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935a956465f1254f80e58c6dacde33ed"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#a935a956465f1254f80e58c6dacde33ed">i2c_driver_trigger_request</a> (uint8_t i2c_device, <a class="el" href="structi2c__packet__t.html">i2c_packet_t</a> *transfer)</td></tr>
<tr class="memdesc:a935a956465f1254f80e58c6dacde33ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trigger a request on the i2c driver.  <a href="#a935a956465f1254f80e58c6dacde33ed">More...</a><br /></td></tr>
<tr class="separator:a935a956465f1254f80e58c6dacde33ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a443fa4be0f8da748c693fb3bb5f8a83d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#a443fa4be0f8da748c693fb3bb5f8a83d">ISR</a> (i2c_int_handler_i2c0, CONF_TWIM_IRQ_GROUP, CONF_TWIM_IRQ_LEVEL)</td></tr>
<tr class="memdesc:a443fa4be0f8da748c693fb3bb5f8a83d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The I2C interrupt handler.  <a href="#a443fa4be0f8da748c693fb3bb5f8a83d">More...</a><br /></td></tr>
<tr class="separator:a443fa4be0f8da748c693fb3bb5f8a83d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89cf2aa9741bf7d6ef45bd531cd1324"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#ab89cf2aa9741bf7d6ef45bd531cd1324">i2c_driver_init</a> (uint8_t i2c_device)</td></tr>
<tr class="memdesc:ab89cf2aa9741bf7d6ef45bd531cd1324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the i2c driver.  <a href="#ab89cf2aa9741bf7d6ef45bd531cd1324">More...</a><br /></td></tr>
<tr class="separator:ab89cf2aa9741bf7d6ef45bd531cd1324"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1eb2acb509cfa6182c582d80a1627927"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1eb2acb509cfa6182c582d80a1627927"></a>
<a class="el" href="structi2c__packet__t.html">i2c_packet_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#a1eb2acb509cfa6182c582d80a1627927">transfer_queue</a> [<a class="el" href="i2c__driver__int_8h.html#a3a2767feb9e861e4b09358231dc29ef5">I2C_SCHEDULE_SLOTS</a>]</td></tr>
<tr class="memdesc:a1eb2acb509cfa6182c582d80a1627927"><td class="mdescLeft">&#160;</td><td class="mdescRight">buffer containing the transfer queue for the i2c <br /></td></tr>
<tr class="separator:a1eb2acb509cfa6182c582d80a1627927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69115ce4f4bae761f55382e10c4fb8cc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a69115ce4f4bae761f55382e10c4fb8cc"></a>
int32_t&#160;</td><td class="memItemRight" valign="bottom"><b>current_slot</b></td></tr>
<tr class="separator:a69115ce4f4bae761f55382e10c4fb8cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e774048dcede38cbac650b942702f6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab9e774048dcede38cbac650b942702f6"></a>
int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#ab9e774048dcede38cbac650b942702f6">last_slot</a></td></tr>
<tr class="memdesc:ab9e774048dcede38cbac650b942702f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">current and last slot for the scheduling of the transfer using i2c <br /></td></tr>
<tr class="separator:ab9e774048dcede38cbac650b942702f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923225e888cb8aa928dfa63bf5868ef5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structi2c__packet__t.html">i2c_packet_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c__driver__int_8c.html#a923225e888cb8aa928dfa63bf5868ef5">current_transfer</a></td></tr>
<tr class="memdesc:a923225e888cb8aa928dfa63bf5868ef5"><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to the i2c structure  <a href="#a923225e888cb8aa928dfa63bf5868ef5">More...</a><br /></td></tr>
<tr class="separator:a923225e888cb8aa928dfa63bf5868ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file is the driver for i2c with interruptions </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab89cf2aa9741bf7d6ef45bd531cd1324"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_driver_init </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2c_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the i2c driver. </p>
<p>Initialize the I2C communication.</p>
<p>The I2C interrupt handler. </p>
<p>&lt; Register PDCA IRQ interrupt.</p>
<p>&lt; Register PDCA IRQ interrupt.</p>
<p>&lt; invalid device ID </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__driver__int_8c_ab89cf2aa9741bf7d6ef45bd531cd1324_cgraph.png" border="0" usemap="#i2c__driver__int_8c_ab89cf2aa9741bf7d6ef45bd531cd1324_cgraph" alt=""/></div>
<map name="i2c__driver__int_8c_ab89cf2aa9741bf7d6ef45bd531cd1324_cgraph" id="i2c__driver__int_8c_ab89cf2aa9741bf7d6ef45bd531cd1324_cgraph">
<area shape="rect" id="node2" href="gpio_8c.html#af9f1a0613d0095efbcd451aea19aad61" title="Enables a specific module mode for a pin. " alt="" coords="156,5,320,32"/><area shape="rect" id="node3" href="gpio_8c.html#ac7473fbcb50b12ed1f89e4af0053d9e3" title="Enables the pull&#45;up resistor of a pin. " alt="" coords="157,56,319,83"/><area shape="rect" id="node4" href="twim_8c.html#ad866d124a926d7c51f91e50448ca2c02" title="Set the twim bus speed in cojunction with the clock frequency. " alt="" coords="373,107,491,133"/><area shape="rect" id="node5" href="twim_8c.html#ae9f6873316c684d6d0b0ed2e9b584352" title="Initialize the twi master module. " alt="" coords="177,157,299,184"/><area shape="rect" id="node10" href="print__util_8c.html#a1b15f576d0bc830fc09c11d034077c43" title="Writes a character string to the debug stream. " alt="" coords="173,208,303,235"/><area shape="rect" id="node6" href="twim_8c.html#aa9d1a4b6781713c05f04fdee5b26524b" title="Test if a chip answers for a given twi address. " alt="" coords="387,157,477,184"/><area shape="rect" id="node7" href="twim_8c.html#a90a8d6459c3b882882a47ae614c1764f" title="Write multiple bytes to a TWI compatible slave device. " alt="" coords="544,157,629,184"/><area shape="rect" id="node8" href="twim_8c.html#ac2aa557dd4843af848081c10049cf29f" title="Disable the TWI interrupts and clear its status register. " alt="" coords="677,132,829,159"/><area shape="rect" id="node9" href="twim_8c.html#a62690e0414009d7ce7ab472a27c7726d" title="Information about the current status of the TWI Bus. " alt="" coords="707,183,800,209"/><area shape="rect" id="node11" href="print__util_8c.html#ae0e520f47e2bfa8e497d3e656e5a9144" title="Writes string of character to a stream. " alt="" coords="368,208,496,235"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a93dd36de61c62b79966587eb2e1cf479"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t i2c_driver_reset </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2c_device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the i2c driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2c_device</td><td>i2c device number</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error status </dd></dl>
<p>&lt; invalid device ID</p>
<p>&lt; Disable TWI interrupts</p>
<p>&lt; Enable master transfer</p>
<p>&lt; Reset TWI </p>

</div>
</div>
<a class="anchor" id="a935a956465f1254f80e58c6dacde33ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t i2c_driver_trigger_request </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>i2c_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structi2c__packet__t.html">i2c_packet_t</a> *&#160;</td>
          <td class="paramname"><em>transfer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trigger a request on the i2c driver. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i2c_device</td><td>i2c device number </td></tr>
    <tr><td class="paramname">transfer</td><td>pointer to an object containing the i2c packet structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error status </dd></dl>
<p>&lt; initiate transfer of given request set up DMA channel</p>
<p>&lt; Enable pdca interrupt each time the reload counter reaches zero, i.e. each time the whole block was received</p>
<p>&lt; Clear the interrupt flags</p>
<p>&lt; invalid device ID</p>
<p>&lt; set up next command register for the burst read transfer set up command register to initiate the write transfer. The DMA will take care of the reading once this is done.</p>
<p>&lt; set up writing of one byte (usually a slave register index) </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="i2c__driver__int_8c_a935a956465f1254f80e58c6dacde33ed_cgraph.png" border="0" usemap="#i2c__driver__int_8c_a935a956465f1254f80e58c6dacde33ed_cgraph" alt=""/></div>
<map name="i2c__driver__int_8c_a935a956465f1254f80e58c6dacde33ed_cgraph" id="i2c__driver__int_8c_a935a956465f1254f80e58c6dacde33ed_cgraph">
<area shape="rect" id="node2" href="twim_8c.html#ad866d124a926d7c51f91e50448ca2c02" title="Set the twim bus speed in cojunction with the clock frequency. " alt="" coords="175,13,292,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a443fa4be0f8da748c693fb3bb5f8a83d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">i2c_int_handler_i2c0&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONF_TWIM_IRQ_GROUP&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CONF_TWIM_IRQ_LEVEL&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The I2C interrupt handler. </p>
<p>&lt; get masked status register value</p>
<p>&lt; this is a NACK</p>
<p>&lt; if we get a nak, clear the valid bit in cmdr, otherwise the command will be resent.</p>
<p>&lt; get data from Receive Holding Register</p>
<p>&lt; finish the receive operation</p>
<p>&lt; set busy to false</p>
<p>&lt; get data from transmit data block</p>
<p>&lt; put the byte in the Transmit Holding Register</p>
<p>&lt;nothing more to write</p>
<p>&lt; reading should already be set up in next command register...</p>
<p>&lt; all done</p>
<p>&lt; set busy to false</p>
<p>&lt; call callback function to process data, at end of transfer to process data, and maybe add some more data </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a923225e888cb8aa928dfa63bf5868ef5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structi2c__packet__t.html">i2c_packet_t</a>* current_transfer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pointer to the i2c structure </p>
<p>Function prototype definition </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 18 2014 14:18:44 for MAV&#39;RIC by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
